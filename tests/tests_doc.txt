#
### ğŸ“‹ 2.1 ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
# ------------------------------------------------
| ãƒ•ã‚¡ã‚¤ãƒ« | å¯¾è±¡ | å†…å®¹ |
|----------|------|------|
| `tests/conftest.py` | å…±é€šè¨­å®š | fixtureã‚„pytestè¨­å®š |
| `tests/test_helper.py` | helper.py | å„ã‚¯ãƒ©ã‚¹ãƒ»é–¢æ•°ã®å˜ä½“ãƒ†ã‚¹ãƒˆ |
| `tests/test_skeleton.py` | a10_00_openai_skeleton.py | ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã®ãƒ†ã‚¹ãƒˆ |
| `tests/test_integration.py` | é€£æºãƒ†ã‚¹ãƒˆ | APIé€£æºãƒ»E2Eãƒ†ã‚¹ãƒˆ |
| `tests/test_ui.py` | UIãƒ†ã‚¹ãƒˆ | Streamlit UIå‹•ä½œãƒ†ã‚¹ãƒˆ |
| `tests/fixtures/` | ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ | ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ãƒ»ã‚µãƒ³ãƒ—ãƒ« |

# ------------------------------------------------
tests/
â”œâ”€â”€ conftest.py              # pytestå…±é€šè¨­å®š
â”œâ”€â”€ test_basic.py            # æœ€å„ªå…ˆã®åŸºæœ¬ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ test_stage1_existence.py # ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
â”œâ”€â”€ test_stage2_helper.py    # helper.pyãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ test_stage3_skeleton.py  # skeleton.pyãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ fixtures/                # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ mock_responses.py    # APIãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿
â”‚   â””â”€â”€ test_data.py         # ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â””â”€â”€ utils/                   # ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
    â””â”€â”€ test_helpers.py      # ãƒ†ã‚¹ãƒˆç”¨è£œåŠ©é–¢æ•°

# ------------------------------------------------
è§£èª¬ã®ç‰¹å¾´
ğŸ“š æ§‹é€ åŒ–ã•ã‚ŒãŸå­¦ç¿’ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
# ------------------------------------------------

ç›®çš„ã¨æˆ¦ç•¥ â†’ ãªãœãƒ†ã‚¹ãƒˆãŒå¿…è¦ã‹
ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ â†’ ã©ã®ã‚ˆã†ã«ãƒ†ã‚¹ãƒˆã‚’çµ„ç¹”åŒ–ã™ã‚‹ã‹
å®Ÿè£…è©³ç´° â†’ å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ä¾‹
å®Ÿè¡Œãƒ»ç¢ºèª â†’ ã©ã®ã‚ˆã†ã«å‹•ã‹ã™ã‹
ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° â†’ å•é¡Œã¸ã®å¯¾å‡¦æ³•

ğŸ’¡ å®Ÿç”¨çš„ãªãƒã‚¤ãƒ³ãƒˆ
ğŸ”§ å³åº§ã«ä½¿ãˆã‚‹å®Ÿè£…

ã‚³ãƒ”ãƒšå¯èƒ½ãªå®Œå…¨ãªã‚³ãƒ¼ãƒ‰ä¾‹
conftest.py: pytestè¨­å®šã¨fixture
test_basic.py: æœ€å„ªå…ˆã®åŸºæœ¬ãƒ†ã‚¹ãƒˆ
æ®µéšçš„ãƒ†ã‚¹ãƒˆ: ç’°å¢ƒâ†’ã‚¤ãƒ³ãƒãƒ¼ãƒˆâ†’æ©Ÿèƒ½â†’çµ±åˆ

ğŸ›¡ï¸ å …ç‰¢ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

ã‚ˆãã‚ã‚‹å•é¡Œã®äº‹å‰å¯¾ç­–
ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ†ã‚¹ãƒˆã®æä¾›

# ------------------------------------------------
pytestå®Ÿè¡Œ
bash# pytestå®Ÿè¡Œï¼ˆè©³ç´°è¡¨ç¤ºï¼‰
pytest tests/test_basic.py -v -s

# å‡ºåŠ›ã®ã¿è¡¨ç¤º
pytest tests/test_basic.py -v -s --tb=short

# å¤±æ•—æ™‚ã®è©³ç´°è¡¨ç¤º
pytest tests/test_basic.py -v -s --tb=long
ğŸ“Š 3.4.2 æœŸå¾…ã•ã‚Œã‚‹çµæœ
âœ… æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³
ğŸ§ª åŸºæœ¬å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆé–‹å§‹
==================================================

ğŸ“‹ TestEnvironment å®Ÿè¡Œä¸­...
âœ… Python ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 3.11.5 (main, ...)
âœ… ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª: a10_00_openai_skeleton.py
âœ… ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª: helper.py
âœ… ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª: config.yaml
âœ… ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª: streamlit
âœ… ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª: openai
âœ… ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª: tiktoken
âœ… ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª: yaml
  âœ… test_python_version: PASSED
  âœ… test_project_structure: PASSED
  âœ… test_dependencies: PASSED

ğŸ“‹ TestBasicImports å®Ÿè¡Œä¸­...
âœ… ã‚¯ãƒ©ã‚¹ç¢ºèª: ConfigManager
âœ… ã‚¯ãƒ©ã‚¹ç¢ºèª: MessageManager
âœ… ã‚¯ãƒ©ã‚¹ç¢ºèª: TokenManager
âœ… ã‚¯ãƒ©ã‚¹ç¢ºèª: UIHelper
âœ… ã‚¯ãƒ©ã‚¹ç¢ºèª: ResponseProcessor
âœ… ã‚¯ãƒ©ã‚¹ç¢ºèª: DemoBase
  âœ… test_import_helper: PASSED
...

ğŸ¯ ãƒ†ã‚¹ãƒˆçµæœ: 12/12 PASSED
ğŸ‰ å…¨ã¦ã®åŸºæœ¬ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ã¾ã—ãŸï¼
âŒ å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾å‡¦æ³•
ã‚¨ãƒ©ãƒ¼å†…å®¹åŸå› å¯¾å‡¦æ³•FileNotFoundError: helper.pyãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ç¢ºèªã€ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç¢ºèªImportError: No module named 'openai'ä¾å­˜é–¢ä¿‚æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«pip install openaiAttributeError: 'module' has no attribute 'ConfigManager'ã‚¯ãƒ©ã‚¹å®šç¾©ã‚¨ãƒ©ãƒ¼helper.py ã®æ§‹æ–‡ç¢ºèªYAML parsing errorconfig.yamlæ§‹æ–‡ã‚¨ãƒ©ãƒ¼YAMLæ§‹æ–‡ç¢ºèª

ğŸ› ï¸ 3.5 ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
ğŸ”§ 3.5.1 ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•

# --------------------------------------------
å•é¡Œ1: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼
python# ã‚¨ãƒ©ãƒ¼ä¾‹
ImportError: No module named 'helper'

# è§£æ±ºæ³•
import sys
from pathlib import Path
PROJECT_ROOT = Path(__file__).parent.parent
sys.path.insert(0, str(PROJECT_ROOT))
print(f"ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‘ã‚¹: {PROJECT_ROOT}")

# --------------------------------------------
å•é¡Œ2: Streamlitä¾å­˜ã‚¨ãƒ©ãƒ¼
python# ã‚¨ãƒ©ãƒ¼ä¾‹
ImportError: No module named 'streamlit'

# è§£æ±ºæ³•ï¼ˆä¸€æ™‚çš„ã‚¹ã‚­ãƒƒãƒ—ï¼‰
try:
    import streamlit as st
except ImportError:
    print("âš ï¸ StreamlitãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ¢ãƒƒã‚¯ä½¿ç”¨ã§ãƒ†ã‚¹ãƒˆç¶šè¡Œ...")
    import sys
    from unittest.mock import MagicMock
    sys.modules['streamlit'] = MagicMock()

# --------------------------------------------
å•é¡Œ3: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
python# ã‚¨ãƒ©ãƒ¼ä¾‹
FileNotFoundError: config.yaml

# è§£æ±ºæ³•
import os
from pathlib import Path

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢
possible_paths = [
    "config.yaml",
    "../config.yaml",
    "./config.yaml"
]

config_path = None
for path in possible_paths:
    if Path(path).exists():
        config_path = path
        break

if config_path is None:
    print("âš ï¸ config.yaml ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šä½¿ç”¨...")

